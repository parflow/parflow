%=============================================================================
% Chapter: Release Process
%=============================================================================

\chapter{Release Process}
\label{Release Process}

The release process for \parflow{} follows the a standard GitHub
release process.  The following steps should be followed for creating a new
\parflow{} release.

\begin{enumerate}
	\item Create branch/fork for generating the release
	\item Edit the RELEASE-NOTES.md file
	\item Regenerate the \parflow{} User Manual
        \item Commit release file changes
        \item Create a pull request for the branch/fork
        \item Merge the pull request
        \item Generate a release on GitHub
\end{enumerate}


\section{Create branch}

Use standard Git/GitHub commands to create a branch for editing some files for the release.

\section{Edit files}

Edit the RELEASE-NOTES.md file to add notes about what was changed in
this release.  Old release notes should be deleted, we do not keep a
running account of release information.

Edit VERSION file with current version.

Edit \code{./docs/user_Manual/conf.py} and update version number.

\section{Regenerate the \parflow{} User Manual}

This should be automated by ReadTheDocs.
  
\section{Commit release file changes}

Use standard git add and git commit commands to add the modified files
to the release branch/fork.

\section{Create a pull request for the branch/fork}

Use GitHub to create a pull request for the release branch.
  
\section{Merge the pull request}

Use GitHub to create a pull request for the release branch.
  
\section{Generate a release on GitHub}

On the GitHub \code{https://github.com/parflow/parflow/releases} page use
``Draft a new release'' to create the release.

Version tag should have format of ``vX.Z.Z'' version.  Release title
should have format of ``ParFlow Version X.Y.Z''.  The GitHub release
description can be copied from the release notes markdown file that
was created in a proir step.

\section{Generate Docker}

\begin{display}\begin{verbatim}
  docker build -t <hub-user>/<repo-name>[:<tag>]
  docker push <hub-user>/<repo-name>:<tag>
\end{verbatim}\end{display}

Example using podman to build and push

\begin{display}\begin{verbatim}
  VERSION=3.12.0
  podman build -t docker.io/parflow/parflow:version-$(VERSION) .
  podman login docker.io
  podman push docker.io/parflow/parflow:version-$(VERSION)
  podman tag docker.io/parflow/parflow:version-$(VERSION) docker.io/parflow/parflow:latest
  podman push  docker.io/parflow/parflow:latest
\end{verbatim}\end{display}
  
